<html lang="en">
<head>
  <title>Admin</title> <!-- web name -->
  <LInk rel="icon" href="./image/logos/logo-02.png" type="image/x-icon"> <!-- web icon -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css-files/body-html.css"> <!-- css file loc -->
  <link rel="stylesheet" href="./css-files/index-css/header.css"> <!-- css file loc -->
  <link rel="stylesheet" href="./css-files/admin-css/admin.css"> <!-- css file loc -->
  <link rel="stylesheet" href="./css-files/buttons.css"> <!-- css file loc -->
  <script type="module" src="./js-filse/admin-js/admin.js"></script>
</head>
<body>
  <!-- header -->
  <div class="header" id="header">
    <div class="logo">
      <h5 class="header-logo-h5">AEYE</h5>
    </div>
    <div class="main-header">
      <a id="all-glasses-header" href="index.html#new-sec" class="aa">Home</a>
      <a id="141414" href="#" class="aa" onclick="
        document.getElementById('ordersss').style.display = 'block';
        document.getElementById('userss').style.display = 'none';
        document.getElementById('products').style.display = 'none';
        document.getElementById('items').style.display = 'none';
        ">Orders</a>
      <a id="151515" href="#" class="aa" onclick="
        document.getElementById('ordersss').style.display = 'none';
        document.getElementById('userss').style.display = 'block';
        document.getElementById('products').style.display = 'none';
        document.getElementById('items').style.display = 'none';
        ">Users</a>
      <a id="151515" href="#" class="aa" onclick="
        document.getElementById('ordersss').style.display = 'none';
        document.getElementById('userss').style.display = 'none';
        document.getElementById('products').style.display = 'block';
        document.getElementById('items').style.display = 'none';
        ">Upload</a>
      <a id="151515" href="#" class="aa" onclick="
      document.getElementById('ordersss').style.display = 'none';
      document.getElementById('userss').style.display = 'none';
      document.getElementById('products').style.display = 'none';
      document.getElementById('items').style.display = 'block';
      ">Products</a>
    </div>
    <div class="login-button-home">
      <div class="bage-center" onclick="window.location.href = './checkout.html';" style="margin-right: 10;">
        <img src="./image/icons/bag.png" alt="" class="header-cart" onclick="">
        <p class="quantity" id="cart-count">2</p>
      </div>
      <a href="orders.html">
        <img src="./image/icons/delivery-truck.png" alt="" class="img-header-login" style="width: 35px; height: 33px;">
      </a>
      <a href="login.html" id="adduser">
      <img src="./image/icons/add-user.png" alt="" class="img-header-login">
      </a>
      <a href="account.html" id="user" style="display: none;">
        <img src="./image/icons/user.png" alt="" class="img-header-login">
      </a>
      <script>
        if (localStorage.getItem('loginmethod') === '555') {
          document.getElementById('adduser').style.display = 'none';
          document.getElementById('user').style.display = 'block';
        }
      </script>
    </div>
  </div>
  <!-- header -->
  <div class="orderss" id="ordersss">
    <div id="admin-container" class="hidden">
      <h1>Admin Panel</h1>
      <!-- أزرار التصفية -->
      <div class="filter-buttons">
        <button class="btntt" onclick="filterOrders('all')">View all</button>
        <button class="btntt" onclick="filterOrders('manufacturing')">Manufacturing</button>
        <button class="btntt" onclick="filterOrders('packing')">Packing</button>
        <button class="btntt" onclick="filterOrders('shipping')">Shipping</button>
      </div>
        <div id="orders-list"></div>
      </div>   
  
      <div id="error-message" class="hidden">
        <h1>Access Denied: Admin Only</h1>  
      </div>    
    </div>
    <div class="user" id="userss">
      <div id="admin-container1" class="hidden">
        <h1>Admin Panel</h1>
        <div id="users-list"></div>
      </div>   
  
      <div id="error-message1" class="hidden">
        <h1>Access Denied: Admin Only</h1>  
      </div>    
    </div>


    <div class="product-continar" id="product-continar">
      <div class="products" id="products">
        <div class="header123" style="display: block;">
          <h1 class="uph1">Choose Your Upload <br> Product Type</h1>
          <div class="upload-style eyeglasses-upload-div" onclick="eyeg()">Eye Glasses</div>
          <div class="upload-style sun-upload-div" onclick="sung()">Sun Glasses</div>
          <div class="upload-style accssoris-upload-div" onclick="accg()">Accssoris</div>
          <div class="upload-style brand-upload-div" onclick="brandg()">Brands</div>
          <div class="upload-style custmize-upload-div" onclick="custg()">Customize</div>
          <script>
            function eyeg() {
              localStorage.setItem('uploadMode', 'EyeGlasses');

              document.querySelector('.eyeglasses-upload-div').style.display = 'none';
              document.querySelector('.sun-upload-div').style.display = 'none';
              document.querySelector('.accssoris-upload-div').style.display = 'none';
              document.querySelector('.brand-upload-div').style.display = 'none';
              document.querySelector('.custmize-upload-div').style.display = 'none';
              document.querySelector('.uph1').style.display = 'none';

              document.querySelector('.upload-containar').style.display = 'block';
              document.getElementById('Product-type-h3').innerText = localStorage.getItem('uploadMode');

            }
            function sung() {
              localStorage.setItem('uploadMode', 'SunGlasses');
              
              document.querySelector('.eyeglasses-upload-div').style.display = 'none';
              document.querySelector('.sun-upload-div').style.display = 'none';
              document.querySelector('.accssoris-upload-div').style.display = 'none';
              document.querySelector('.brand-upload-div').style.display = 'none';
              document.querySelector('.custmize-upload-div').style.display = 'none';
              document.querySelector('.uph1').style.display = 'none';

              document.querySelector('.upload-containar').style.display = 'block';
              document.getElementById('Product-type-h3').innerText = localStorage.getItem('uploadMode');
            }
            function accg() {
              localStorage.setItem('uploadMode', 'Accssoris');
              
              document.querySelector('.eyeglasses-upload-div').style.display = 'none';
              document.querySelector('.sun-upload-div').style.display = 'none';
              document.querySelector('.accssoris-upload-div').style.display = 'none';
              document.querySelector('.brand-upload-div').style.display = 'none';
              document.querySelector('.custmize-upload-div').style.display = 'none';
              document.querySelector('.uph1').style.display = 'none';

              document.querySelector('.upload-containar').style.display = 'block';
              document.getElementById('Product-type-h3').innerText = localStorage.getItem('uploadMode');
            }
            function brandg() {
              localStorage.setItem('uploadMode', 'Brand');
              
              document.querySelector('.eyeglasses-upload-div').style.display = 'none';
              document.querySelector('.sun-upload-div').style.display = 'none';
              document.querySelector('.accssoris-upload-div').style.display = 'none';
              document.querySelector('.brand-upload-div').style.display = 'none';
              document.querySelector('.custmize-upload-div').style.display = 'none';
              document.querySelector('.uph1').style.display = 'none';

              document.querySelector('.upload-containar').style.display = 'block';
              document.getElementById('Product-type-h3').innerText = localStorage.getItem('uploadMode');
            }
            function custg() {
              localStorage.setItem('uploadMode', 'Customize');
              
              document.querySelector('.eyeglasses-upload-div').style.display = 'none';
              document.querySelector('.sun-upload-div').style.display = 'none';
              document.querySelector('.accssoris-upload-div').style.display = 'none';
              document.querySelector('.brand-upload-div').style.display = 'none';
              document.querySelector('.custmize-upload-div').style.display = 'none';
              document.querySelector('.uph1').style.display = 'none';

              document.querySelector('.upload-containar').style.display = 'block';
              document.getElementById('Product-type-h3').innerText = localStorage.getItem('uploadMode');
            }
          </script>
        </div>
        

        <!-- containar -->
        <div class="upload-containar" id="upload-containar" style="display: none;">
          <h1 class="rawan">Add Your Product<br>Informtion</h1>
          <div class="line1">
            <h3 class="h3-pr">Product Type:&nbsp;&nbsp;</h3>
            <h3 id="Product-type-h3"></h3>
          </div>
          <div class="line">
            <h3 class="h3-pr">Product id:&nbsp;&nbsp;</h3>
            <input class="Name" id="iderror" type="text">
          </div>
          <div class="line">
            <h3 class="h3-pr">Product Name:&nbsp;&nbsp;</h3>
            <input class="Name" id="nameerror" type="text">
          </div>
          <div class="line">
            <h3 class="h3-pr">Product Quantity:&nbsp;&nbsp;</h3>
            <input class="Name" id="quantityerror" type="text">
          </div>
          <div class="line">
            <h3 class="h3-pr">Product Price:&nbsp;&nbsp;</h3>
            <input class="Name" id="priceerror" type="text">
          </div>
          <div class="line">
            <h3 class="h3-pr">Product Sale:&nbsp;&nbsp;</h3>
            <input class="Name" id="saleerror" type="text">
          </div>
          <div class="line">
            <h3 class="h3-pr">Product Lens:&nbsp;&nbsp;</h3>
            <input class="Name" id="lenserror" type="text">
          </div>
          <div class="line">
            <h3 class="h3-pr">Product Descr:&nbsp;&nbsp;</h3>
            <input class="Name" id="deserror" type="text">
          </div>
          <div class="line">
            <h3 class="h3-pr">Product Img Url:&nbsp;&nbsp;</h3>
            <input class="Name" id="imgerror" type="text">
          </div>
          <!-- erorr messege -->
          <div class="error-massage-1" id="error-massage-12">
            <p style="margin-bottom: 10px;">Error Message Well be here please fill all felds</p>
          </div>
          <button id="upload-button" class="upload-bt button-animation2">Upload</button>
        </div>
      </div>
    </div>
    <!-- erorr messege -->
    <div id="error-message2" class="hidden">
      <h1>Access Denied: Admin Only</h1>  
    </div> 

    <div class="items-continar" id="items-continar">
      <div class="items" id="items">
        <div class="container">
          <h1>Product Management</h1>
          <div class="search-container">
            <input type="text" id="searchById" placeholder="Search by ID">
            <input type="text" id="searchByName" placeholder="Search by Name">
          </div>
          <div class="products-grid" id="productsGrid"></div>
        </div>
      
        <script type="module">
          // Import Firebase modules
          import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
          import { getFirestore, doc, setDoc, getDoc, collection, getDocs, updateDoc } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";
      
          // Firebase configuration
          const firebaseConfig = {
            apiKey: "AIzaSyA2Yl1VfdSjLfa3WGEszCOs4uA9vLAJVN0",
            authDomain: "aeye-52e5c.firebaseapp.com",
            projectId: "aeye-52e5c",
            storageBucket: "aeye-52e5c.appspot.com",
            messagingSenderId: "721877823117",
            appId: "1:721877823117:web:5e789ac89e2baf9abffcc4",
            measurementId: "G-4NGC51320Q"
          };
      
          // Initialize Firebase
          const app = initializeApp(firebaseConfig);
          const db = getFirestore(app);
      
          // Fetch and display products
          async function fetchProducts() {
            const productsGrid = document.getElementById('productsGrid');
            productsGrid.innerHTML = ''; // Clear previous content
      
            const querySnapshot = await getDocs(collection(db, 'products'));
            querySnapshot.forEach((doc) => {
              const product = doc.data();
              const productCard = `
                <div class="product-card" data-id="${product.id}">
                  <div class="id">ID: ${product.id}</div>
                  <img src="${product.img}" alt="${product.name}">
                  <input type="text" id="name-${product.id}" value="${product.name}" placeholder="Product Name">
                  <input type="number" id="price-${product.id}" value="${product.price}" placeholder="Price">
                  <input type="text" id="sale-${product.id}" value="${product.sale}" placeholder="Sale">
                  <input type="text" id="lens-${product.id}" value="${product.lens}" placeholder="Lens">
                  <input type="text" id="desc-${product.id}" value="${product.productDesc}" placeholder="Description">
                  <input type="text" id="img-${product.id}" value="${product.img}" placeholder="Image URL">
                  <input type="number" id="quantity-${product.id}" value="${product.quantity || 0}" placeholder="Quantity">
                  <div class="quantity-control">
                    <input type="number" id="addQuantity-${product.id}" placeholder="Add Quantity">
                    <button onclick="addQuantity('${product.id}')"><i class="fas fa-plus"></i> Add</button>
                  </div>
                  <button onclick="saveChanges('${product.id}')">Save Changes</button>
                </div>
              `;
              productsGrid.innerHTML += productCard;
            });
          }
      
          // Add quantity
          window.addQuantity = function (id) {
            const quantityInput = document.getElementById(`quantity-${id}`);
            const addQuantityInput = document.getElementById(`addQuantity-${id}`);
            const currentQuantity = parseInt(quantityInput.value) || 0;
            const addQuantity = parseInt(addQuantityInput.value) || 0;
            quantityInput.value = currentQuantity + addQuantity;
            addQuantityInput.value = ''; // Clear the input
          };
      
          // Save changes
          window.saveChanges = async function (id) {
            const name = document.getElementById(`name-${id}`).value;
            const price = document.getElementById(`price-${id}`).value;
            const sale = document.getElementById(`sale-${id}`).value;
            const lens = document.getElementById(`lens-${id}`).value;
            const desc = document.getElementById(`desc-${id}`).value;
            const img = document.getElementById(`img-${id}`).value;
            const quantity = document.getElementById(`quantity-${id}`).value;
      
            try {
              await updateDoc(doc(db, 'products', id), {
                name,
                price: parseFloat(price),
                sale,
                lens,
                productDesc: desc,
                img,
                quantity: parseInt(quantity, 10)
              });
              alert('Changes saved successfully!');
            } catch (error) {
              console.error('Error updating product:', error);
              alert('Error saving changes.');
            }
          };
      
          // Search by ID
          document.getElementById('searchById').addEventListener('input', async (e) => {
            const searchTerm = e.target.value.trim();
            if (searchTerm) {
              const docRef = doc(db, 'products', searchTerm);
              const docSnap = await getDoc(docRef);
              if (docSnap.exists()) {
                const product = docSnap.data();
                document.getElementById('productsGrid').innerHTML = `
                  <div class="product-card" data-id="${product.id}">
                    <div class="id">ID: ${product.id}</div>
                    <img src="${product.img}" alt="${product.name}">
                    <input type="text" id="name-${product.id}" value="${product.name}" placeholder="Product Name">
                    <input type="number" id="price-${product.id}" value="${product.price}" placeholder="Price">
                    <input type="text" id="sale-${product.id}" value="${product.sale}" placeholder="Sale">
                    <input type="text" id="lens-${product.id}" value="${product.lens}" placeholder="Lens">
                    <input type="text" id="desc-${product.id}" value="${product.productDesc}" placeholder="Description">
                    <input type="text" id="img-${product.id}" value="${product.img}" placeholder="Image URL">
                    <input type="number" id="quantity-${product.id}" value="${product.quantity || 0}" placeholder="Quantity">
                    <div class="quantity-control">
                      <input type="number" id="addQuantity-${product.id}" placeholder="Add Quantity">
                      <button onclick="addQuantity('${product.id}')"><i class="fas fa-plus"></i> Add</button>
                    </div>
                    <button onclick="saveChanges('${product.id}')">Save Changes</button>
                  </div>
                `;
              } else {
                document.getElementById('productsGrid').innerHTML = '<p>No product found with this ID.</p>';
              }
            } else {
              fetchProducts();
            }
          });
      
          // Search by name
          document.getElementById('searchByName').addEventListener('input', async (e) => {
            const searchTerm = e.target.value.trim().toLowerCase();
            if (searchTerm) {
              const querySnapshot = await getDocs(collection(db, 'products'));
              const productsGrid = document.getElementById('productsGrid');
              productsGrid.innerHTML = ''; // Clear previous content
      
              querySnapshot.forEach((doc) => {
                const product = doc.data();
                if (product.name.toLowerCase().includes(searchTerm)) {
                  const productCard = `
                    <div class="product-card" data-id="${product.id}">
                      <div class="id">ID: ${product.id}</div>
                      <img src="${product.img}" alt="${product.name}">
                      <input type="text" id="name-${product.id}" value="${product.name}" placeholder="Product Name">
                      <input type="number" id="price-${product.id}" value="${product.price}" placeholder="Price">
                      <input type="text" id="sale-${product.id}" value="${product.sale}" placeholder="Sale">
                      <input type="text" id="lens-${product.id}" value="${product.lens}" placeholder="Lens">
                      <input type="text" id="desc-${product.id}" value="${product.productDesc}" placeholder="Description">
                      <input type="text" id="img-${product.id}" value="${product.img}" placeholder="Image URL">
                      <input type="number" id="quantity-${product.id}" value="${product.quantity || 0}" placeholder="Quantity">
                      <div class="quantity-control">
                        <input type="number" id="addQuantity-${product.id}" placeholder="Add Quantity">
                        <button onclick="addQuantity('${product.id}')"><i class="fas fa-plus"></i> Add</button>
                      </div>
                      <button onclick="saveChanges('${product.id}')">Save Changes</button>
                    </div>
                  `;
                  productsGrid.innerHTML += productCard;
                }
              });
      
              if (productsGrid.innerHTML === '') {
                productsGrid.innerHTML = '<p>No product found with this name.</p>';
              }
            } else {
              fetchProducts();
            }
          });
      
          // Initial fetch
          fetchProducts();
        </script>
      </div>
    </div>
    <div id="error-message3" class="hidden">
      <h1>Access Denied: Admin Only</h1>  
    </div> 




</body>
</html>